{
  "hash": "8578584b749cd0dcea2080fe653cce82",
  "result": {
    "markdown": "---\ntitle: \"Drought in Arizona\"\nsubtitle: \"INFO 526 - Project Final\"\nauthor: \"Graph Gurus\"\nformat: html\neditor: visual\n---\n\n\n##### Load Data and Libraries\n\n\n::: {.cell}\n\n```{.r .cell-code}\nif (!require(pacman)) install.packages(pacman)\n\npacman::p_load(tidyverse, formattable, dlookr, readxl, writexl)\n\nlibrary(shiny)\nlibrary(ggplot2)\nlibrary(thematic)\nlibrary(ragg)\nlibrary(readr)\nlibrary(stringr)\nlibrary(shinydashboard)\nlibrary(readxl)\nlibrary(tidyr)\nlibrary(sf)\nlibrary(dplyr)\nlibrary(geojsonio)\n\ndrought_df <- read_excel(\"Shiny App/data/drought_data.xlsx\", sheet = \"Total Area by County\")\npercent_drought_df <- read_excel(\"Shiny App/data/drought_data.xlsx\", sheet = \"Percent Area by County\")\n# Load GeoJSON data for Arizona counties\narizona_counties <- st_read(\"Shiny App/data/arizona-with-county-boundaries_1085.geojson\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nReading layer `arizona-with-county-boundaries_1085' from data source \n  `C:\\Users\\sweth\\OneDrive\\Desktop\\project-final-Graph-Gurus\\Shiny App\\data\\arizona-with-county-boundaries_1085.geojson' \n  using driver `GeoJSON'\nSimple feature collection with 15 features and 5 fields\nGeometry type: POLYGON\nDimension:     XY\nBounding box:  xmin: -114.815 ymin: 31.329 xmax: -109.045 ymax: 37.005\nGeodetic CRS:  WGS 84\n```\n:::\n:::\n\n\n## Abstract\n\nThis project aims to explore and interpret the data on Arizona's enduring drought conditions, a climatic challenge that disrupts the balance of life and has adverse effects on the state's future. The investigation is driven by a combination of curiosity and the recognition of water scarcity as an issue that is deeply connected to Arizona's residents. By exploring this database, we seek to gain valuable insights into the dynamic nature of Arizona's drought experiences.\n\nWe aim to create easy-to-understand visuals that depict the current situation and stimulate thinking about potential solutions. A close examination of how different areas are dealing with water shortages will help us determine where to focus our efforts to contribute to the mitigation of this issue. Through this project, we hope to shed light on the severity of the drought and inspire action towards sustainable water management practices in Arizona.\n\n## Introduction\n\nArizona is known for its dry weather, and for over 20 years, it's been dealing with a serious drought. This isn't just about the weather - it affects everything from nature to people's jobs and the state's economy. This drought reminds us of similar events in the 1900s and 1950s, and it's clear that we need to take a closer look at what's happening.\n\nOur recent interactions with individuals actively raising awareness about the dire drought situation and the adverse effects of water wastage have further inspired this exploration. The project's objective is not only to provide valuable data for our visualization but also to offer a profound understanding of the challenges faced by the state.\n\n## Motivation\n\nWe're not just interested in this from a scientific point of view. People living in Arizona are genuinely worried about the lack of water, and we've been inspired by those who are passionate about saving water. We want to dig deeper into this important issue. Our goal isn't just to analyze data; we want to understand the big challenges Arizona is facing and share this information with others.\n\n## Motive\n\nOur main goal with this project is to raise awareness and encourage action. We're not just making a data visualization; we want to change how people think, start conversations, and help everyone understand how serious Arizona's drought is. By creating an interactive dashboard about the drought, we hope to help users interact with the data, understand the trends, and think about possible solutions. In the end, we want to encourage everyone, from ordinary people to policymakers, to take steps towards managing water resources in a sustainable way.\n\n## Analysis\n\n### **Question 1: How has the severity of drought changed over time in Arizona?**\n\nThe variability of drought over time is a critical aspect of climate patterns, especially for arid regions like Arizona. This variability can have profound effects on water allocation, agricultural planning, and natural ecosystems. While historical trends have been studied, the nuanced changes within these trends, and the frequency and intensity of extreme drought conditions, remain areas requiring deeper exploration. In recent years, technological advances and data collection efforts have provided an unprecedented amount of climatic data, offering new opportunities to analyze drought patterns with greater precision. This wealth of data paves the way for more detailed temporal analysis, allowing for a better understanding of the cyclical nature and potential shifts in drought severity.\n\n#### Approach:\n\nTo answer how drought severity has shifted over time in Arizona, we initiated a time series analysis focusing on yearly data aggregated across the state's counties. We meticulously preprocessed the drought data, first by extracting the year from each record, then by computing yearly averages for each drought level, including the 'None' category. To ensure comparability across years and counties, we normalized these figures into percentages, painting a clearer picture of annual drought severity changes. With this foundation, we crafted a color-coded stacked bar chart, each hue representing a different drought level, providing an immediate visual understanding of how these levels stack up year over year. Concurrently, we developed a time series plot that layers these annual percentages, offering a dynamic portrayal of drought trends over the decades and inviting an interactive exploration of the data for more nuanced insights.\n\n#### Analysis for Q1\n\n\n::: {.cell fig.showtext='true'}\n\n```{.r .cell-code}\n# Preprocess the data to obtain Year\ndrought_df <- drought_df %>%\n  mutate(Year = format(as.Date(Date), \"%Y\"))\n\n# Calculate the yearly average for each drought level including 'None'\nyearly_data <- drought_df %>%\n  group_by(Year, County) %>%\n  summarise(across(c(None:D4), mean, na.rm = TRUE)) %>%\n  pivot_longer(cols = c(None:D4), names_to = \"Drought_Level\", values_to = \"Value\")\n\n# Normalize the values to percentages\nyearly_data <- yearly_data %>%\n  group_by(Year, County) %>%\n  mutate(Percentage = Value / sum(Value) * 100) %>%\n  ungroup()\n```\n:::\n\n::: {.cell fig.showtext='true'}\n\n```{.r .cell-code}\ndrought_colors <- c(\n  \"None\" = \"#FFFFFF\", # Assuming 'None' is white\n  \"D0\" = \"#FFFF00\", # Yellow\n  \"D1\" = \"#FFA500\", # Orange\n  \"D2\" = \"#FF0000\", # Red\n  \"D3\" = \"#8B0000\", # Dark Red\n  \"D4\" = \"#654321\"  # Brown\n)\n```\n:::\n\n\n##### BARPLOT\n\n\n::: {.cell fig.showtext='true'}\n\n```{.r .cell-code}\n#Plot\nggplot(yearly_data, aes(x = Year, y = Percentage, fill = Drought_Level)) +\n      geom_bar(stat = \"identity\", position = \"fill\") +\n      scale_fill_manual(values = drought_colors) +\n      scale_y_continuous(labels = scales::percent_format()) +\n      labs(title = \"Average Yearly Drought Levels\", x = \"Year\", y = \"Percentage\", fill = \"Drought Level\") +\n      theme_minimal() + \n      theme(axis.text.x = element_text(angle = 90, vjust = 0.5))\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/stacked bar plot-1.png){width=672}\n:::\n:::\n\n\n##### TIMESERIES PLOT\n\n\n::: {.cell fig.showtext='true'}\n\n```{.r .cell-code}\n# Filter county data\ncounty_data <- drought_df %>%\n      group_by(Year, County) %>%\n      summarise(across(c(None:D4), mean, na.rm = TRUE)) %>%\n      pivot_longer(cols = c(None:D4), names_to = \"Drought_Level\", values_to = \"Value\") %>%\n      mutate(Percentage = Value / sum(Value) * 100) %>%\n      ungroup()\n    \n    county_data$Year <- as.Date(paste0(county_data$Year, \"-01-01\"))\n    \n\n#Plot\n    p <- ggplot(county_data, aes(x = Year, y = Percentage, fill = Drought_Level)) +\n      geom_area(alpha = 0.7, stat = \"identity\") +\n      scale_fill_manual(values = drought_colors) +\n      scale_y_continuous(labels = function(x) paste0(x, \"%\")) +\n      labs(x = \"Year\", y = \"Percentage\", title = paste(\"Drought Level over the years\")) +\n      theme_minimal() +\n      theme(legend.position = \"right\",\n            plot.title = element_text(hjust = 0.6, size = 12),\n            legend.text = element_text(size = 8),\n            legend.title = element_text(size = 10)) +\n      guides(fill = guide_legend(title.position = \"top\", title.hjust = 0.5))\n```\n:::\n\n\n### **Question 2: What are the most affected areas in Arizona in terms of drought severity?**\n\nWhile our initial analysis highlighted the temporal dynamics of drought in Arizona, we realized that understanding the spatial distribution of drought severity across different counties was equally crucial. This line of inquiry is particularly important because drought impacts vary significantly across regions due to diverse geographical and climatic conditions. For example, some counties might consistently experience higher levels of severe drought categories (such as D3 or D4), indicating a greater vulnerability to drought effects.\n\n### Analysis\n\nOur approach to this question involves a detailed analysis using a donut plot integrated with a Leaflet map. We start by processing our drought data to calculate the proportion of each drought severity level within individual counties. This involves summarizing the area affected by each drought level for a selected county and then transforming these values into percentages. The resultant donut plot provides a clear visual representation of the drought severity distribution within the selected county.\n\nWhen a user interacts with the Leaflet map and selects a county, the donut plot dynamically updates to display the percentage breakdown of drought levels for that particular area. This interactive feature is crucial for understanding the specific drought conditions in different parts of Arizona, allowing us to identify which counties are most severely affected.\n\n#### Analysis for Q2\n\n\n::: {.cell fig.showtext='true'}\n\n```{.r .cell-code}\n#Calculate percentages\n    \n    drought_totals <- drought_df %>% \n      summarise(D0 = sum(D0, na.rm = TRUE),\n                D1 = sum(D1, na.rm = TRUE),\n                D2 = sum(D2, na.rm = TRUE),\n                D3 = sum(D3, na.rm = TRUE),\n                D4 = sum(D4, na.rm = TRUE),\n                None = sum(None, na.rm = TRUE)) %>%\n      pivot_longer(cols = everything(), names_to = \"Drought_Level\", values_to = \"Area\")\n    \n    # Calculate percentages\n    total_area <- sum(drought_totals$Area)\n    drought_totals <- drought_totals %>%\n      mutate(Percentage = Area / total_area * 100)\n```\n:::\n\n\n##### DONUT PLOT\n\n\n::: {.cell fig.showtext='true'}\n\n```{.r .cell-code}\nggplot(drought_totals, aes(x = 2, y = Percentage, fill = Drought_Level)) +\n      geom_bar(stat = \"identity\", width = 1) +\n      coord_polar(theta = \"y\") +\n      theme_void() +\n      scale_fill_manual(values = drought_colors) +\n      geom_text(aes(label = sprintf(\"%0.2f%%\", Percentage)), position = position_stack(vjust = 0.5)) +\n      xlim(c(0.15, 2.5))\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/donut plot-1.png){width=672}\n:::\n:::\n\n\nThis spatial analysis is not only critical for current drought management strategies but also sets the foundation for our next line of inquiry. Understanding the distribution of drought severity levels in different counties leads us naturally to Question 3, where we explore whether there's a correlation between drought severity and specific times of the year.\n\n### Question 3: **Is there a correlation between drought severity and certain times of the year?**\n\nBuilding on our understanding of drought severity distribution across Arizona's counties, we aim to further examine if these drought conditions correlate with particular times of the year. This investigation is crucial for identifying seasonal patterns in drought severity, which can inform more effective drought management and preparedness strategies.\n\n### Approach:\n\nIn addressing Question 3, our focus shifted to understanding if drought severity in Arizona correlates with specific times of the year, a crucial aspect for planning and mitigating drought impacts effectively. To analyse, we utilized a choropleth map, a powerful tool for visualizing geographical data, which shows drought severity levels across different counties on selected dates. We began with preprocessing of the geospatial drought data and then we streamlined the dataset by renaming and selecting essential columns, ensuring data types were consistent for accurate mapping. We then merged this data with detailed geographic information of Arizona counties, assigning weights to each drought level to compute a 'Drought Score.' This score was normalized to provide a consistent scale for comparison across counties. By incorporating user-selected dates, our choropleth map dynamically reflects the drought severity for any given day, visually represented through color gradients corresponding to different drought levels. This interactive and detailed visualization allows us to investigate if certain times of the year are consistently more prone to severe drought conditions, thereby addressing the question of seasonal correlation with drought severity in Arizona.\n\n#### Analysis for Q3\n\n\n::: {.cell fig.showtext='true'}\n\n```{.r .cell-code}\n#Rename Column from name to County\n  arizona_counties_new <- dplyr::rename(arizona_counties, County = name)\n  \n  #Drop all columns ecept County and geometry\n  arizona_counties_new <- arizona_counties_new %>%\n    select(County, geometry)\n  \n  #Convert to req data types\n  percent_drought_df$County <- as.character(percent_drought_df$County)\n  arizona_counties_new$County <- as.character(arizona_counties_new$County)\n  percent_drought_df$Date<- as.Date(percent_drought_df$Date)\n  \n  drought_data_geospatial <- percent_drought_df %>%\n    left_join(arizona_counties_new, by = \"County\")\n  \n  # Assign weights to the drought levels\n  drought_weights <- c(None = 0, D0 = 1, D1 = 2, D2 = 3, D3 = 4, D4 = 5)\n  \n  # Calculate 'Drought Score' by multiplying the area percentages by the weights\n  drought_data_geospatial <- drought_data_geospatial %>%\n    mutate(Drought_Score = (None * drought_weights[[\"None\"]]) +\n             (D0 * drought_weights[[\"D0\"]]) +\n             (D1 * drought_weights[[\"D1\"]]) +\n             (D2 * drought_weights[[\"D2\"]]) +\n             (D3 * drought_weights[[\"D3\"]]) +\n             (D4 * drought_weights[[\"D4\"]]))\n  \n  # Normalize 'Drought Score' \n  # Assuming that the maximum possible score is 5 (for D4 at 100% coverage)\n  drought_data_geospatial <- drought_data_geospatial %>%\n    mutate(Normalized_Score = Drought_Score / max(Drought_Score))\n  \n  #Make sure your date column is type date\n  drought_data_geospatial$Date <- as.Date(drought_data_geospatial$Date)\n```\n:::\n\n\n##### CHLOROPLETH MAP\n\n\n::: {.cell fig.showtext='true'}\n\n```{.r .cell-code}\n#Pick a date of intreset for our report, passing as an input to shiny\ndates_of_interest <- as.Date(c(\"2005-04-26 UTC\"))\n\n#Filter with date\ndrought_data_filtered <- drought_data_geospatial %>%\n  filter(Date %in% dates_of_interest)\n    \n    \n      # Plot the map with ggplot2 and sf\n    ggplot(data = drought_data_filtered) +\n      geom_sf(data = drought_data_filtered$geometry,\n              aes(fill = drought_data_filtered$Normalized_Score), color = \"black\", size = 0.2) +\n      scale_fill_gradientn(\n        colors = drought_colors,\n        name = \"Drought Level\",\n        breaks = c(0, 1, 2, 3, 4, 5), \n        labels = c(\"None\", \"D0\", \"D1\", \"D2\", \"D3\", \"D4\"), # Specifying the labels for the breaks\n        limits = c(0, 5), \n        oob = scales::oob_squish\n      ) +\n      labs(title = paste(\"Drought Levels in Arizona on 2005-04-26\")) +\n      theme_minimal() +\n      theme(\n        legend.position = \"right\",\n        axis.text.x = element_blank(),\n        axis.text.y = element_blank(),\n        axis.title.x = element_blank(),\n        axis.title.y = element_blank(),\n        axis.ticks = element_blank()\n      )\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/Chloropleth map-1.png){width=672}\n:::\n:::\n\n\n\\\n\n## Interpretation\n\n1.  Short Term Drought Conditions:\n\n    ![](images/ShortTerm.jpg)\n\n2.  Long Term Drought Conditions:\n\n    ![](images/LongTerm.jpg)\n\n## Conclusion\n\nOur deep dive into Arizona's drought conditions has given us a clear picture of a state struggling with long-term water shortages. Our interactive dashboard, which uses data visualization, has helped us understand this complex environmental issue. By analyzing data from the past twenty years, we've been able to track how drought severity has changed across different parts of Arizona, highlighting the problems faced by people, nature, and businesses.\n\nOur detailed visualizations and statistical analyses have shown us just how serious the situation is. From slightly dry conditions to extreme drought, each stage has a growing impact on farming, water supplies, and the state's overall health. The changing severity of the drought has not only put Arizona's natural environment to the test but also called for immediate policy changes and community-led actions.\n\nOur goal to involve, inform, and inspire action aligns with the need for teamwork. The data doesn't just tell a story of hardship; it acts as a trigger for change. As we conclude this report, the need for sustainable management of water resources is clear. The responsibility falls not just on policymakers but on every citizen to adopt water-saving habits, encourage innovation, and support policies that protect Arizona's water supply for the future.\n\nIn short, this project is more than just about drought data; it's about our shared duty to protect Arizona's vital water resources. The process of exploring and visualizing the data has highlighted the need for a coordinated approach. It's a call to action, an invitation to turn knowledge into meaningful actions. We hope this report will act as a guide, leading us towards a future where Arizona is more resilient and mindful of water usage.\n",
    "supporting": [
      "index_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}